---

- name: 'Download NodeJS repo'
  get_url:
    dest: '/tmp/nodesource_setup.sh'
    url: https://deb.nodesource.com/setup_18.x
    mode: 0755
  when: ansible_facts['os_family'] == "Ubuntu"

- name: 'Add NodeJS Repo'
  shell:
    chdir: '/tmp'
    cmd: './nodesource_setup.sh'
  when: ansible_facts['os_family'] == "Ubuntu"

- name: 'Remove nodejs shell script'
  file:
    state: absent
    path: /tmp/nodesource_setup.sh
  when: ansible_facts['os_family'] == "Ubuntu"

- name: Install NodeJS from Official Repositories
  GROG.package:
    package_list:
      - name: nodejs
        pacman: node
        apt: nodejs
      - name: npm
        pacman: npm
        apt: npm

- name: Install yarn and pnpm
  npm:
    name: '{{ item }}'
    state: latest
    global: yes
  with_items:
    - pnpm
    - yarn
